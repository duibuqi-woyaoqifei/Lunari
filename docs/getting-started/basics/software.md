# 💻 软件基础介绍

## 1. 操作系统（Operating System, OS）

在嵌入式开发中，程序要么直接运行在硬件上（裸机），要么运行在一个轻量级的操作系统上（RTOS）。

### 裸机编程（Bare-metal）

- **无操作系统，程序直接跑在芯片上。**
- 没有任务调度、没有多线程，一切都由你自己控制。
- 更贴近硬件，是理解嵌入式底层原理的最佳起点。
- 响应快、资源占用低，适合小型、单任务项目。

> **初学建议：**
> 我们将从裸机编程入手，先学会控制引脚、点亮 LED，再逐步过渡到更复杂的系统结构。

---

### 实时操作系统（RTOS）

- 提供任务调度、时间管理、同步机制等多任务支持。
- 适合需要多个模块并行运行的复杂项目。
- 常见 RTOS 有：
  - **FreeRTOS**：开源、小巧、广泛使用。
  - **RT-Thread**：国产 RTOS，生态丰富。
  - **Zephyr**：Linux 基金会支持，适合物联网项目。

> 后续我们也会引导你逐步接触 RTOS，在理解“任务切换”与“时间片调度”后，你会发现裸机与 RTOS 的组合，能覆盖绝大多数嵌入式项目需求。

## 2. 编译工具链（Toolchain）

在嵌入式开发中，写好的 C / C++ 代码并不能直接在芯片上运行，它们需要被「翻译」成机器可以理解的二进制文件。这项翻译任务由 **编译工具链（Toolchain）** 完成。

### 编译工具链的作用

- 将源代码编译成目标文件（`.o`）
- 链接所有文件生成可执行程序（`.elf` 或 `.bin`）
- 生成用于烧录的固件文件
- 有时还包括调试工具、头文件、标准库等

### 推荐工具链：GCC ARM Embedded

- 完全开源，跨平台支持（Windows、Linux、macOS）
- 生态完善：支持 CMSIS、Makefile、CMake、VS Code 等主流开发环境
- 官方由 ARM 维护，适配主流 ARM Cortex-M 系列芯片
- 便于集成：可嵌入 CI/CD 流程，支持自动编译与测试。

> ✅ **本教程使用 GCC ARM Embedded 工具链**

### 其他常见工具链（了解即可）

| 工具链 | 特点 | 适用场景 | 缺点 |
|--------|------|----------|------|
| **Keil MDK** | 商业软件，图形化强，集成度高，操作简单 | 学校教学、传统企业、快速上手项目 | 免费版代码容量限制（32KB），收费较贵，跨平台支持差（仅 Windows） |
| **IAR Embedded Workbench** | 商业软件，编译器优化能力强，生成代码效率高 | 对性能/功耗要求高的产品，如可穿戴设备、传感器节点等 | 授权昂贵，界面老旧，调试功能依赖自家工具链 |

> **GCC 工具链在自由度、可移植性和社区资源** 上具有明显优势，更适合开源学习路线。

## 3. 调试与烧录

### 调试（Debug）

调试是帮助你了解程序运行状态、发现并修复问题的过程。

- **串口调试（UART）**  
  最基础的调试方式，通过 `printf()` 输出变量值或程序流程到串口终端。  

- **仿真器调试（SWD / JTAG）**  
  使用 ST-Link、J-Link 等仿真器连接开发板：
  - 单步执行
  - 断点设置
  - 实时查看变量/寄存器  

> ✅ **本教程使用 ST-Link（ST 官方调试器）**

### 烧录（Flashing）

烧录是将编译好的程序写入 MCU 的 Flash，让它独立运行代码。

- **常见方式**：
  - 串口烧录（通过 BOOT 引脚进入 Bootloader 模式）
  - SWD / JTAG 烧录（通过 ST-Link、J-Link）
  - USB 烧录（部分 MCU 支持 USB Boot）

- **常用工具**：
  - STM32CubeProgrammer（官方）
  - ST-Link Utility（轻量易用）
  - OpenOCD + GDB（开源，高度自由）

> ✅ **本教程使用 OpenOCD + GDB（开源调试方案）**

## 4. 开发环境（IDE）

- 开发环境集成了代码编辑、编译、调试等功能，提升开发效率和体验。
- 支持代码自动补全、语法高亮、版本控制集成等现代功能。
- 常用 IDE 及特点：

| IDE               | 特点                                                         | 适用场景                     |
|-------------------|--------------------------------------------------------------|------------------------------|
| **STM32CubeIDE**   | ST 官方免费IDE，集成STM32库和配置工具，适合STM32开发         | STM32 新手及项目开发          |
| **Keil uVision**   | 商业软件，图形界面强大，支持丰富的调试功能                    | 传统企业及教学               |
| **PlatformIO**     | 跨平台、跨芯片，基于 VS Code，插件丰富，支持多种开发板       | 多平台、多项目需求开发者      |
| **VS Code + 插件** | 轻量、灵活，可自由配置，支持多种语言和调试器                  | 喜欢自定义和开源工具链的开发者 |

### VS Code 的优点

- **轻量且快速**：启动速度快，占用资源低，适合日常开发。
- **高度可扩展**：通过丰富的插件市场支持各种语言、工具链和调试器。
- **跨平台支持**：Windows、macOS、Linux 全面兼容。
- **集成终端**：内置命令行终端，方便执行编译、烧录、调试命令。
- **智能代码补全**：强大的 IntelliSense 支持，提升编程效率。
- **强大的调试功能**：支持多种调试协议和远程调试。
- **Git 集成**：内置版本控制，方便代码管理和协作。
- **社区活跃**：大量开源插件和示例，持续更新和支持。
- **远程开发支持**：通过 Remote-SSH、WSL 等功能实现远程或容器内开发。
- **多语言支持**：不仅支持 C/C++，还支持 Python、JavaScript、Rust 等多种语言。

> ✅ **本教程使用 VS Code（自由配置）**

## 5. 配置与代码生成利器

在 STM32 开发过程中，STM32CubeMX 是一款非常实用的辅助工具，它可以极大简化开发流程。

### 什么是 STM32CubeMX？

- **图形化配置工具**  
  通过直观的图形界面配置 MCU 的引脚、时钟、外设以及中间件，避免手动查阅大量数据手册。
  
- **自动代码生成**  
  根据配置自动生成基于 STM32 HAL 库的初始化代码，帮你快速搭建项目框架，节省大量底层设置时间。

- **简化开发流程**  
  通过图形界面完成硬件资源分配与功能规划，减少错误配置，提高开发效率。

## ✅ 建议准备的软件工具

1. **Visual Studio Code (VS Code)**  —— 代码编辑器

2. **STM32CubeMX**  —— 图形化配置工具

3. **OpenOCD (Open On-Chip Debugger)**  —— 调试工具

4. **GCC ARM Embedded Toolchain**  —— ARM Cortex-M 编译器

5. **STM32CubeIDE（可选）**  —— ST 官方免费集成开发环境

6. **ST-Link Utility / STM32CubeProgrammer（可选）**  —— ST 官方烧录和调试工具

### 🪟 **本教程所有演示使用 Windows 11 操作系统**